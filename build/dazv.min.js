!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Dazv=t.Dazv||{})}(this,function(t){"use strict";function e(t){var e={};return t=t||"v",e[t]?e[t]+=1:e[t]=1,t+e[t]}function i(){return document.createElement("div")}function o(t){return t&&t.length?Array.prototype.slice.call(t):[]}function a(){var t=this.toArray(arguments),e=t[0];if(e!==!0){for(var i=1;i<t.length;i++){var n=t[i];for(var o in n)n.hasOwnProperty(o)&&"constructor"!==o&&(e[o]=n[o])}return e}e=t[1];for(var i=2;i<t.length;i++){var n=t[i];r(e,n)}}function r(t,e,i){var o=5;i=i||0;for(var a in e)if(e.hasOwnProperty(a)){var r=e[a];null!==r&&s.isObject(r)?(s.isObject(t[a])||(t[a]={}),i<o?n(t[a],e[a],i+1):t[a]=e[a]):s.isArray(r)?(t[a]=[],t[a]=t[a].concat(r)):void 0!==r&&(t[a]=e[a])}}function h(t){var e,i=t.id,n=document.getElementById(i);if(!n&&!e)throw new Error("please specify the canvas container Id !");if(n&&e)throw new Error('please specify the "container" or "id" property !');if(!e){var o=u.guid("v-chart");t.container=e=u.createDiv(),e.id=o,e.style.position="relative",n.appendChild(e)}return e}function l(t){this.width=t.width,this.height=t.height,this.containerDOM=t.container,this.fontFamily=t.fontFamily,this.init()}function c(t){var e=t.margin;this.start={x:e[3],y:e[0]},this.end={x:t.width-e[1],y:t.height-e[2]},this.width=this.end.x-this.start.x,this.height=this.end.y-this.start.y}function d(t){t=t||{},this.gradient=t.gradient||{.1:"#DF5A5A",.2:"#DF775A",.3:"#DF945A",.4:"#DFB05A",.5:"#DFCD5A",.6:"#D4DF5A",.7:"#B7DF5A",.8:"#9ADF5A",.9:"#7DDF5A",1:"#61DF5A"},this.width=t.width||1,this.height=t.height||256,this.min=t.min||0,this.max=t.max||300,this.init()}function f(t){this.options=t,this.splitList=t.splitList||{},this.type=t.type||"continuous",this.calculable=t.calculable,this.init()}function p(t,e){this.options=t,this.init(e)}function g(t){var e=this;t=t||{},e.options=u.mix({},v,t),e.init()}function y(t,e){var i=new l({width:t.width,height:t.height,container:t.container,fontFamily:t.fontFamily});return e&&i.addTopLeft(),i}var m="1.0.0",u={guid:e,createDiv:i,mix:a,toArray:o},v={width:1e3,height:500,fontFamily:'"Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", SimSun, "sans-serif"',viewCfg:{margin:[20,60,60,60]},axisCfg:{line:{lineWidth:1,stroke:"#ccc",fill:"#f1f1f1"},labels:{fontSize:12,fill:"#3c3c3c"},title:{fontSize:12,fill:"#999"},tickLine:{lineWidth:1,stroke:"#ccc",value:5},titleOffset:42,lableOffset:10,rows:12,cols:31,space:0,isIntersect:!0},legendCfg:{show:!0,type:"piecewise",min:0,max:300,width:13,height:180,textGap:10,selectedMode:"multiple",itemSymbol:"roundRect",itemWidth:20,itemHeight:10,itemGap:14,wordSpaceing:8,left:16,bottom:5,calculable:!0,textStyle:{fontSize:12,fontFamily:'"Microsoft YaHei", "微软雅黑", SimSun, "sans-serif"',color:"#3c3c3c"},gradient:{.1:"#fe0000",.2:"#ff3801",.3:"#ff7300",.4:"#ffaa01",.5:"#fae200",.6:"#e5f500",.7:"#b0e000",.8:"#84cf00",.9:"#5aba00",1:"#38a702"},splitList:[{start:0,end:50,color:"#00E400",level:"优"},{start:50,end:100,color:"#FFFF00",level:"良"},{start:100,end:150,color:"#FF7E00",level:"轻度污染"},{start:150,end:200,color:"#FF0000",level:"中度污染"},{start:200,end:300,color:"#99004C",level:"重度污染"},{start:300,color:"#7E0023",level:"严重污染"}]},toolTip:{show:!0,position:[5,5],triggerOn:"mousemove",style:"position:absolute;background-Color:rgba(0,0,0,0.7);transition:top 0.2s,left 0.2s;border-radius: 2px;color:#fff;line-height: 16px;padding:5px 10px;"}};l.prototype.init=function(){var t=this.containerDOM.childNodes.length,e=document.createElement("canvas"),i=e.getContext("2d");e.id="canvas_"+(t+1),e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.containerDOM.appendChild(e),this.canvasDOM=e,this.context=i},l.prototype.addTopLeft=function(){var t=this.canvasDOM;t.style.position="absolute",t.style.top=0,t.style.left=0},c.prototype.drawLine=function(t){var e=.5;t.strokeStyle="#eee",t.beginPath(),t.moveTo(this.start.x+e,this.start.y+e),t.lineTo(this.end.x+e,this.start.y+e),t.lineTo(this.end.x+e,this.end.y+e),t.lineTo(this.start.x+e,this.end.y+e),t.lineTo(this.start.x+e,this.start.y+e),t.stroke()},d.prototype.init=function(){var t=this.gradient,e=document.createElement("canvas");e.width=this.width,e.height=this.height;var i=this.context=e.getContext("2d"),n=i.createLinearGradient(0,0,e.width,e.height);for(var o in t)n.addColorStop(parseFloat(o),t[o]);i.fillStyle=n,i.fillRect(0,0,e.width,e.height)},d.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},d.prototype.getColor=function(t){var e=this.max;t>e&&(e=t);var i=4*Math.floor((e-t)/e*(this.height-1)),n=this.context.getImageData(0,0,1,this.height).data;return"rgba("+n[i]+", "+n[i+1]+", "+n[i+2]+", 1)"},f.prototype.init=function(){if("piecewise"==this.type&&this.calculable)for(var t=new d(this.options),e=this.splitList,i=0;i<e.length;i++)e[i].color=t.getColor(e[i].start)},f.prototype.get=function(t){for(var e=this.splitList,i=!1,n=0;n<e.length;n++)if((void 0===e[n].start||void 0!==e[n].start&&t>e[n].start)&&(void 0===e[n].end||void 0!==e[n].end&&t<=e[n].end)){i=e[n];break}return i},p.prototype.init=function(t){var e=this.options;this.start={x:t.end.x+e.left,y:t.end.y-e.bottom-e.height-e.textGap},this.end={x:t.end.x+e.left+e.width,y:t.end.y-e.bottom-e.textGap}},p.prototype.draw=function(t){if(this.options.show)switch(this.options.type){case"piecewise":this.drawByPieceWise(t);break;default:this.drawByContinuous(t)}},p.prototype.drawByContinuous=function(t){var e=this.options,i=new d({width:e.width,height:e.height,min:e.min,max:e.max,gradient:e.gradient});t.putImageData(i.getImageData(),this.start.x,this.start.y),t.save(),t.font=e.textStyle.fontSize+"px "+e.textStyle.fontFamily,t.fillStyle=e.textStyle.color,t.textAlign="center",t.textBaseline="middle",t.fillText(e.max,this.start.x+e.width/2,this.start.y-e.textGap),t.fillText(e.min,this.start.x+e.width/2,this.end.y+e.textGap),t.restore()},p.prototype.drawByPieceWise=function(t){new f(this.options);switch(this.options.itemSymbol){case"circle":this.drawCircle(t);break;case"rect":this.drawRect(t);break;case"roundRect":this.drawRoundRect(t)}},p.prototype.drawCircle=function(t){for(var e=this.options,i=e.itemHeight/2,n=0;n<e.splitList.length;n++){var o=e.splitList[n],a=this.start.x+i,r=this.end.y-e.itemHeight*n-e.itemGap*n-i;t.fillStyle=o.color,t.beginPath(),t.arc(a,r,i,0,2*Math.PI,!0),t.closePath(),t.fill(),t.save(),t.textAlign="left",t.textBaseline="middle",t.font=e.textStyle.fontSize+"px "+e.textStyle.fontFamily,t.fillStyle=e.textStyle.color,t.fillText(o.level,a+i+e.wordSpaceing,r),t.restore()}},p.prototype.drawRect=function(t){for(var e=this.options,i=e.itemHeight/2,n=0;n<e.splitList.length;n++){var o=e.splitList[n],a=this.start.x,r=this.end.y-e.itemHeight*(n+1)-e.itemGap*n;t.fillStyle=o.color,t.fillRect(a,r,e.itemWidth,e.itemHeight),t.save(),t.textAlign="left",t.textBaseline="middle",t.font=e.textStyle.fontSize+"px "+e.textStyle.fontFamily,t.fillStyle=e.textStyle.color,t.fillText(o.level,a+e.itemWidth+e.wordSpaceing,r+i),t.restore()}},p.prototype.drawRoundRect=function(t){for(var e=this.options,i=e.itemHeight/2,n=3,o=0;o<e.splitList.length;o++){var a=e.splitList[o],r=this.start.x,s=this.end.y-e.itemHeight*(o+1)-e.itemGap*o;t.fillStyle=a.color,t.beginPath(),t.moveTo(r+n,s),t.arcTo(r+e.itemWidth,s,r+e.itemWidth,s+e.itemHeight,n),t.arcTo(r+e.itemWidth,s+e.itemHeight,r,s+e.itemHeight,n),t.arcTo(r,s+e.itemHeight,r,s,n),t.arcTo(r,s,r+n,s,n),t.closePath(),t.fill(),t.save(),t.textAlign="left",t.textBaseline="middle",t.font=e.textStyle.fontSize+"px "+e.textStyle.fontFamily,t.fillStyle=e.textStyle.color,t.fillText(a.level,r+e.itemWidth+e.wordSpaceing,s+i),t.restore()}},p.prototype.getTextWidthHeight=function(t){var e=document.createElement("span"),i=this.options;e.style.font=i.textStyle.fontSize+"px "+i.textStyle.fontFamily,e.innerText=t,document.body.appendChild(e);var n={width:e.offsetWidth,height:e.offsetHeight};return document.body.removeChild(e),n},g.prototype.init=function(){var t=this,e=t.options;t.container=h(e);var i=t.backCanvas=y(e,!1);t.midCanvas=y(e,!0),t.foreCanvas=y(e,!0);var n=t.view=new c({width:e.width,height:e.height,margin:e.viewCfg.margin}),o=t.legend=new p(e.legendCfg,n);n.drawLine(t.backCanvas.context),o.draw(i.context)},g.prototype.get=function(t){return this[t]},t.version=m,t.Chart=g,Object.defineProperty(t,"__esModule",{value:!0})});